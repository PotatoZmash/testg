local Players = game:GetService("Players")
local CollectionService = game:GetService("CollectionService")
local lp = Players.LocalPlayer
local guiParent = game:GetService("CoreGui")

if guiParent:FindFirstChild("MiniEggGUI") then
    guiParent.MiniEggGUI:Destroy()
end

-- 🥚 Full Egg Chances
local eggChances = {
    ["Common Egg"] = { ["Golden Lab"] = 33.33, ["Dog"] = 33.33, ["Bunny"] = 33.33 },
    ["Common Summer Egg"] = { ["Starfish"] = 50, ["Seagull"] = 25, ["Crab"] = 25 },
    ["Rare Summer Egg"] = { ["Flamingo"] = 30, ["Toucan"] = 25, ["Sea Turtle"] = 20, ["Orangutan"] = 15, ["Seal"] = 10 },
    ["Paradise Egg"] = { ["Ostrich"] = 40, ["Peacock"] = 30, ["Capybara"] = 21, ["Scarlet Macaw"] = 8, ["Mimic Octopus"] = 1 },
    ["Mythical Egg"] = { ["Grey Mouse"] = 35.71, ["Brown Mouse"] = 26.79, ["Squirrel"] = 26.79, ["Red Giant Ant"] = 8.93, ["Red Fox"] = 1.79 },
    ["Bee Egg"] = { ["Bee"] = 65, ["Honey Bee"] = 25, ["Bear Bee"] = 5, ["Petal Bee"] = 4, ["Queen Bee"] = 1 },
    ["Bug Egg"] = { ["Snail"] = 40, ["Giant Ant"] = 30, ["Caterpillar"] = 25, ["Praying Mantis"] = 4, ["Dragonfly"] = 1 },
    ["Anti Bee Egg"] = { ["Wasp"] = 55, ["Tarantula Hawk"] = 30, ["Moth"] = 13.75, ["Butterfly"] = 1, ["Disco Bee"] = 0.25 },
    ["Oasis Egg"] = { ["Meerkat"] = 45, ["Sand Snake"] = 34.5, ["Axolotl"] = 15, ["Hyacinth Macaw"] = 5, ["Fennec Fox"] = 0.5 },
    ["Dinosaur Egg"] = { ["Triceratops"] = 32.5, ["Raptor"] = 35, ["Stegosaurus"] = 28, ["Pterodactyl"] = 3, ["Brontosaurus"] = 1, ["T-Rex"] = 0.5 },
    ["Uncommon Egg"] = { ["Black Bunny"] = 25, ["Chicken"] = 25, ["Cat"] = 25, ["Deer"] = 25 },
    ["Rare Egg"] = { ["Orange Tabby"] = 33.33, ["Spotted Deer"] = 25, ["Pig"] = 16.67, ["Rooster"] = 16.67, ["Monkey"] = 8.33 },
    ["Legendary Egg"] = { ["Cow"] = 42.55, ["Silver Monkey"] = 42.55, ["Sea Otter"] = 10.64, ["Turtle"] = 2.13, ["Polar Bear"] = 2.13 },
    ["Night Egg"] = { ["Hedgehog"] = 49, ["Mole"] = 22, ["Frog"] = 14, ["Echo Frog"] = 10, ["Night Owl"] = 4, ["Reccoon"] = 1 }
}

-- 🎲 Weighted Pet Randomizer
local function randomPet(eggType)
    local pets = eggChances[eggType]
    if not pets then return nil end
    local total, roll = 0, 0
    for _, chance in pairs(pets) do total += chance end
    roll = math.random() * total
    local cumulative = 0
    for pet, chance in pairs(pets) do
        cumulative += chance
        if roll <= cumulative then return pet end
    end
end

-- GUI Setup
local gui = Instance.new("ScreenGui", guiParent)
gui.Name = "MiniEggGUI"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 250, 0, 150)
frame.Position = UDim2.new(0, 50, 0, 120)
frame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
frame.Active = true
frame.Draggable = true
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 10)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 25)
title.Text = "Egg Reseter"
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.Antique
title.TextSize = 19
title.BackgroundTransparency = 1

local box = Instance.new("TextBox", frame)
box.Size = UDim2.new(0.9, 0, 0, 30)
box.Position = UDim2.new(0.05, 0, 0.25, 0)
box.PlaceholderText = "Egg Name (e.g. Common Egg)"
box.TextSize = 19
box.Text = ""
box.Font = Enum.Font.Antique
box.TextColor3 = Color3.new(1, 1, 1)
box.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
Instance.new("UICorner", box).CornerRadius = UDim.new(0, 6)

local btn = Instance.new("TextButton", frame)
btn.Size = UDim2.new(0.9, 0, 0, 30)
btn.Position = UDim2.new(0.05, 0, 0.65, 0)
btn.Text = "Reset Egg"
btn.TextSize = 19
btn.Font = Enum.Font.Antique
btn.TextColor3 = Color3.new(1, 1, 1)
btn.BackgroundColor3 = Color3.fromRGB(70, 130, 70)
Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)

-- Cooldown with countdown text
local cooldown = false

btn.MouseButton1Click:Connect(function()
    if cooldown then return end

    local eggName = box.Text
    local pet = randomPet(eggName)
    if not pet then
        box.Text = "❌ Invalid Egg!"
        return
    end

    for _, egg in pairs(CollectionService:GetTagged("PetEggServer")) do
        if egg:GetAttribute("EggName") == eggName and egg:GetAttribute("OWNER") == lp.Name then
            local old = egg:FindFirstChild("FakePetESP")
            if old then old:Destroy() end

            local gui = Instance.new("BillboardGui", egg)
            gui.Name = "FakePetESP"
            gui.Adornee = egg:FindFirstChildWhichIsA("BasePart") or egg.PrimaryPart or egg
            gui.Size = UDim2.new(0, 200, 0, 50)
            gui.StudsOffset = Vector3.new(0, 2.5, 0)
            gui.AlwaysOnTop = true

            local lbl = Instance.new("TextLabel", gui)
            lbl.Size = UDim2.new(1, 0, 1, 0)
            lbl.BackgroundTransparency = 1
            lbl.Text = eggName .. " | " .. pet
            lbl.TextColor3 = Color3.new(1, 1, 1)
            lbl.TextStrokeTransparency = 0
            lbl.TextSize = 19
            lbl.Font = Enum.Font.Antique
        end
    end

    cooldown = true
    local countdown = 8
    btn.Text = "Cooldown: " .. countdown .. "s"
    task.spawn(function()
        while countdown > 0 do
            task.wait(1)
            countdown -= 1
            btn.Text = "Cooldown: " .. countdown .. "s"
        end
        cooldown = false
        btn.Text = "Reset Egg"
    end)
end)
